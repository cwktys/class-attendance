<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>班級到達操場管理系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, get, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // 🔥 請將下面的設定改為您從Firebase複製的設定
        const firebaseConfig = {
            apiKey: "AIzaSyAqLitpQ-W2EFVJb5ytlh_fFaXEfGdsOns",
            authDomain: "classroom-tracker-demo.firebaseapp.com",
            databaseURL: "https://classroom-tracker-demo-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "classroom-tracker-demo",
            storageBucket: "classroom-tracker-demo.firebasestorage.app",
            messagingSenderId: "889652567824",
            appId: "1:889652567824:web:e9017d7dc072b0c8624f95"
",
            appId: "請貼上您的APP ID"
        };

        // 初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // 讓其他腳本可以使用 database
        window.database = database;
        window.dbRef = ref;
        window.dbSet = set;
        window.dbGet = get;
        window.dbOnValue = onValue;
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .arrived {
            animation: pulse 2s ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .status-badge {
            transition: all 0.3s ease;
        }

        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            z-index: 1000;
        }

        .connected {
            background-color: #10B981;
            color: white;
        }

        .disconnected {
            background-color: #EF4444;
            color: white;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    },
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-gray-900 min-h-screen transition-colors duration-300">
    <!-- 連線狀態指示 -->
    <div id="connectionStatus" class="connection-status disconnected">
        🔴 離線
    </div>

    <div class="w-full h-full">
        <!-- 手機版布局 -->
        <div class="md:hidden">
            <!-- 手機版：頂部橫向布局 -->
            <div class="flex gap-3 mb-3">
                <!-- 校徽 -->
                <div class="flex-shrink-0">
                    <img src="https://pfst.cf2.poecdn.net/base/image/d1bac803e09e2aa47fef77acb1020b7332c5512b872f9ac730ecee837ec17c8e?w=200&h=237" 
                         alt="校徽" 
                         class="w-20 h-24 object-contain">
                </div>
                
                <!-- 統計資訊 -->
                <div class="flex gap-2 flex-1">
                    <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg p-2 text-center flex-1">
                        <div class="text-lg font-bold text-blue-600 dark:text-blue-400" id="totalClassesMobile">0</div>
                        <div class="text-blue-800 dark:text-blue-300 text-xs">總數</div>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/30 rounded-lg p-2 text-center flex-1">
                        <div class="text-lg font-bold text-green-600 dark:text-green-400" id="arrivedClassesMobile">0</div>
                        <div class="text-green-800 dark:text-green-300 text-xs">已到達</div>
                    </div>
                    <div class="bg-orange-50 dark:bg-orange-900/30 rounded-lg p-2 text-center flex-1">
                        <div class="text-lg font-bold text-orange-600 dark:text-orange-400" id="pendingClassesMobile">0</div>
                        <div class="text-orange-800 dark:text-orange-300 text-xs">未到達</div>
                    </div>
                </div>
            </div>
            
            <!-- 手機版：尚未到達班級警示區 -->
            <div id="pendingAlertMobile">
                <!-- 將由 JavaScript 動態生成 -->
            </div>
            
            <!-- 標題區域 -->
            <div class="text-center mb-3">
                <h1 class="text-xl font-bold text-gray-800 dark:text-white mb-1">
                    班級到達操場管理
                </h1>
                <p class="text-gray-600 dark:text-gray-300 text-sm">
                    點擊班級按鈕來標記到達狀態 - 即時同步
                </p>
            </div>

            <!-- 控制按鈕 -->
            <div class="flex gap-2 justify-center mb-3">
                <button onclick="resetAll()" 
                        class="px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors duration-200 text-sm">
                    重置全部
                </button>
                <button onclick="markAllArrived()" 
                        class="px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-medium transition-colors duration-200 text-sm">
                    全部到達
                </button>
            </div>

            <!-- 班級列表 -->
            <div class="grid grid-cols-4 gap-2" id="classGridMobile">
                <!-- 班級卡片將由 JavaScript 動態生成 -->
            </div>
        </div>

        <!-- 桌面版：專為1920x1080優化的全屏顯示版 -->
        <div class="hidden md:flex flex-col w-screen h-screen overflow-hidden p-8 gap-8">
            <!-- 頂部：校徽居中 - 1920x1200優化 -->
            <div class="flex justify-center items-center" style="height: 240px;">
                <img src="https://pfst.cf2.poecdn.net/base/image/d1bac803e09e2aa47fef77acb1020b7332c5512b872f9ac730ecee837ec17c8e?w=200&h=237" 
                     alt="校徽" 
                     class="w-48 h-56 object-contain">
            </div>

            <!-- 已到達班級顯示區域 - 充分利用1920x1080剩餘空間 -->
            <div class="flex-1 w-full" id="pendingAlert">
                <!-- 將由 JavaScript 動態生成 -->
            </div>
        </div>
    </div>

    <script>
        // 深色模式檢測
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // 班級資料
        const classes = [
            { id: 'class1A', name: '1A', grade: 1 },
            { id: 'class1B', name: '1B', grade: 1 },
            { id: 'class1C', name: '1C', grade: 1 },
            { id: 'class1D', name: '1D', grade: 1 },
            { id: 'class2A', name: '2A', grade: 2 },
            { id: 'class2B', name: '2B', grade: 2 },
            { id: 'class2C', name: '2C', grade: 2 },
            { id: 'class2D', name: '2D', grade: 2 },
            { id: 'class3A', name: '3A', grade: 3 },
            { id: 'class3B', name: '3B', grade: 3 },
            { id: 'class3C', name: '3C', grade: 3 },
            { id: 'class3D', name: '3D', grade: 3 }
        ];

        // 班級狀態
        let classStatus = {};
        let isFirebaseReady = false;

        // 等待 Firebase 初始化
        function waitForFirebase() {
            if (window.database) {
                isFirebaseReady = true;
                setupFirebaseListeners();
                updateConnectionStatus(true);
                loadDataFromFirebase();
            } else {
                setTimeout(waitForFirebase, 100);
            }
        }

        // 設置 Firebase 監聽器
        function setupFirebaseListeners() {
            const statusRef = window.dbRef(window.database, 'classStatus');
            let isFirstLoad = true;
            
            window.dbOnValue(statusRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    const newStatus = data;
                    
                    // 檢測狀態變化並播放語音（只針對網頁版）
                    if (!isFirstLoad && window.innerWidth >= 768) {
                        // 比較新舊狀態，找出變化的班級
                        Object.keys(newStatus).forEach(classId => {
                            const oldValue = classStatus[classId];
                            const newValue = newStatus[classId];
                            
                            // 如果狀態有變化，播放語音
                            if (oldValue !== newValue) {
                                const className = classes.find(cls => cls.id === classId)?.name;
                                if (className) {
                                    // 延遲一點播放語音，確保UI更新完成
                                    setTimeout(() => {
                                        playArrivalAnnouncement(className, newValue);
                                    }, 300);
                                }
                            }
                        });
                    }
                    
                    classStatus = newStatus;
                    renderClasses();
                    isFirstLoad = false;
                }
            });
        }

        // 從 Firebase 載入資料
        async function loadDataFromFirebase() {
            try {
                const statusRef = window.dbRef(window.database, 'classStatus');
                const snapshot = await window.dbGet(statusRef);
                if (snapshot.exists()) {
                    classStatus = snapshot.val();
                } else {
                    // 如果沒有資料，初始化預設狀態
                    initializeClasses();
                    await saveToFirebase();
                }
                renderClasses();
            } catch (error) {
                console.error('載入資料失敗:', error);
                updateConnectionStatus(false);
                initializeClasses();
                renderClasses();
            }
        }

        // 儲存到 Firebase
        async function saveToFirebase() {
            if (!isFirebaseReady) return;
            try {
                const statusRef = window.dbRef(window.database, 'classStatus');
                await window.dbSet(statusRef, classStatus);
            } catch (error) {
                console.error('儲存失敗:', error);
                updateConnectionStatus(false);
            }
        }

        // 更新連線狀態顯示
        function updateConnectionStatus(connected) {
            const statusEl = document.getElementById('connectionStatus');
            if (connected) {
                statusEl.className = 'connection-status connected';
                statusEl.innerHTML = '🟢 已連線';
            } else {
                statusEl.className = 'connection-status disconnected';
                statusEl.innerHTML = '🔴 離線';
            }
        }

        // 初始化班級狀態
        function initializeClasses() {
            classes.forEach(cls => {
                classStatus[cls.id] = false;
            });
        }

        // 創建班級卡片
        function createClassCard(cls) {
            const isArrived = classStatus[cls.id];
            
            return `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 overflow-hidden border ${isArrived ? 'border-green-500' : 'border-gray-200 dark:border-gray-700'}">
                    <div class="p-3">
                        <div class="text-center mb-3">
                            <div class="flex items-center justify-center mb-2">
                                <h3 class="text-xl font-bold text-gray-800 dark:text-white mr-2">
                                    ${cls.name}
                                </h3>
                                <span class="status-badge inline-flex items-center px-3 py-1 rounded-full text-base font-bold ${isArrived ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400' : 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'}">
                                    ${isArrived ? '✅ 已到達' : '⏳ 未到達'}
                                </span>
                            </div>
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${getGradeColor(cls.grade)}">
                                ${cls.grade}年級
                            </span>
                        </div>
                        
                        <button onclick="toggleClassStatus('${cls.id}')" 
                                class="w-full px-3 py-2 rounded-lg font-medium transition-all duration-200 text-sm ${isArrived ? 'bg-orange-500 hover:bg-orange-600 text-white' : 'bg-primary hover:bg-primary/90 text-white'}">
                            ${isArrived ? '標記未到達' : '標記已到達'}
                        </button>
                    </div>
                </div>
            `;
        }

        // 獲取年級顏色
        function getGradeColor(grade) {
            const colors = {
                1: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400',
                2: 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400',
                3: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400'
            };
            return colors[grade] || 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';
        }

        // 渲染班級列表
        function renderClasses() {
            // 手機版班級列表
            const classGridMobile = document.getElementById('classGridMobile');
            if (classGridMobile) {
                const classCards = classes.map(cls => createClassCard(cls)).join('');
                classGridMobile.innerHTML = classCards;
            }
            
            updateStatistics();
        }

        // 語音播報功能（根據設備選擇語言，優先女聲）
        function playArrivalAnnouncement(className, isArrived) {
            // 檢查瀏覽器是否支援語音合成
            if ('speechSynthesis' in window) {
                try {
                    // 檢測是否為桌面版（網頁版）
                    const isDesktop = window.innerWidth >= 768; // md 斷點
                    
                    let message, language, rate;
                    
                    if (isDesktop) {
                        // 網頁版：使用廣東話
                        message = isArrived ? `${className}班已經到咗` : `${className}班已經走咗`;
                        language = 'zh-HK';
                        rate = 0.7; // 放慢語速，避免被截斷
                    } else {
                        // 手機版：使用中文
                        message = isArrived ? `${className}班已到達` : `${className}班已離開`;
                        language = 'zh-TW';
                        rate = 0.8; // 稍微放慢語速
                    }
                    
                    // 等待語音引擎準備好
                    const waitForVoices = () => {
                        return new Promise((resolve) => {
                            const voices = window.speechSynthesis.getVoices();
                            if (voices.length > 0) {
                                resolve(voices);
                            } else {
                                // 等待語音載入完成
                                window.speechSynthesis.onvoiceschanged = () => {
                                    resolve(window.speechSynthesis.getVoices());
                                };
                            }
                        });
                    };
                    
                    waitForVoices().then((voices) => {
                        // 只有當前面沒有語音在播放時才停止
                        if (window.speechSynthesis.speaking) {
                            window.speechSynthesis.cancel();
                            // 等待一下確保完全停止
                            setTimeout(() => {
                                playVoice();
                            }, 100);
                        } else {
                            playVoice();
                        }
                        
                        function playVoice() {
                            const utterance = new SpeechSynthesisUtterance(message);
                            utterance.lang = language;
                            utterance.rate = rate;
                            utterance.pitch = 1.1; // 稍微提高音調
                            utterance.volume = 1.0;
                            
                            let selectedVoice = null;
                            
                            if (isDesktop) {
                                // 網頁版：優先選擇廣東話女聲
                                selectedVoice = voices.find(voice => 
                                    (voice.lang.includes('zh-HK') || voice.lang.includes('yue')) &&
                                    (voice.name.toLowerCase().includes('female') || 
                                     voice.name.toLowerCase().includes('woman') ||
                                     voice.name.toLowerCase().includes('佳') ||
                                     voice.name.toLowerCase().includes('欣') ||
                                     voice.name.toLowerCase().includes('美') ||
                                     voice.name.toLowerCase().includes('麗'))
                                );
                                
                                // 如果沒找到女聲，就找任何廣東話語音
                                if (!selectedVoice) {
                                    selectedVoice = voices.find(voice => 
                                        voice.lang.includes('zh-HK') || 
                                        voice.lang.includes('yue') ||
                                        voice.name.toLowerCase().includes('cantonese') ||
                                        voice.name.toLowerCase().includes('hongkong')
                                    );
                                }
                            } else {
                                // 手機版：優先選擇中文女聲
                                selectedVoice = voices.find(voice => 
                                    voice.lang.includes('zh') &&
                                    (voice.name.toLowerCase().includes('female') || 
                                     voice.name.toLowerCase().includes('woman') ||
                                     voice.name.toLowerCase().includes('佳') ||
                                     voice.name.toLowerCase().includes('欣') ||
                                     voice.name.toLowerCase().includes('美') ||
                                     voice.name.toLowerCase().includes('麗'))
                                );
                            }
                            
                            if (selectedVoice) {
                                utterance.voice = selectedVoice;
                                console.log(`使用${isDesktop ? '廣東話' : '中文'}女聲: ${selectedVoice.name}`);
                            } else {
                                console.log(`未找到${isDesktop ? '廣東話' : '中文'}女聲，使用預設語音`);
                            }
                            
                            // 設定語音事件監聽
                            utterance.onstart = () => {
                                console.log(`開始播放語音: ${message}`);
                            };
                            
                            utterance.onend = () => {
                                console.log(`語音播放完成: ${message}`);
                            };
                            
                            utterance.onerror = (error) => {
                                console.log('語音播放錯誤:', error);
                            };
                            
                            // 播放語音
                            window.speechSynthesis.speak(utterance);
                        }
                    });
                    
                } catch (error) {
                    console.log('語音播報失敗:', error);
                }
            } else {
                console.log('瀏覽器不支援語音合成');
            }
        }

        // 切換班級狀態
        async function toggleClassStatus(classId) {
            const oldStatus = classStatus[classId];
            const newStatus = !oldStatus;
            
            classStatus[classId] = newStatus;
            
            // 播放語音通知
            const className = classes.find(cls => cls.id === classId)?.name;
            if (className) {
                playArrivalAnnouncement(className, newStatus);
            }
            
            // 立即更新UI
            renderClasses();
            
            // 儲存到 Firebase
            await saveToFirebase();
        }

        // 重置全部
        async function resetAll() {
            Object.keys(classStatus).forEach(classId => {
                classStatus[classId] = false;
            });
            renderClasses();
            await saveToFirebase();
        }

        // 標記全部到達
        async function markAllArrived() {
            Object.keys(classStatus).forEach(classId => {
                classStatus[classId] = true;
            });
            renderClasses();
            await saveToFirebase();
        }

        // 更新統計資訊
        function updateStatistics() {
            const total = classes.length;
            const arrived = Object.values(classStatus).filter(status => status).length;
            const pending = total - arrived;

            // 桌面版 - 檢查元素是否存在（簡化版沒有統計元素）
            const totalClassesEl = document.getElementById('totalClasses');
            const arrivedClassesEl = document.getElementById('arrivedClasses');
            const pendingClassesEl = document.getElementById('pendingClasses');
            
            if (totalClassesEl) totalClassesEl.textContent = total;
            if (arrivedClassesEl) arrivedClassesEl.textContent = arrived;
            if (pendingClassesEl) pendingClassesEl.textContent = pending;
            
            // 手機版
            document.getElementById('totalClassesMobile').textContent = total;
            document.getElementById('arrivedClassesMobile').textContent = arrived;
            document.getElementById('pendingClassesMobile').textContent = pending;
            
            updatePendingAlert();
            updatePendingAlertMobile();
        }

        // 更新已到達班級顯示區
        function updatePendingAlert() {
            const pendingAlertDiv = document.getElementById('pendingAlert');
            const arrivedClasses = classes.filter(cls => classStatus[cls.id]);
            
            if (arrivedClasses.length === 0) {
                pendingAlertDiv.innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-800/30 border border-gray-200 dark:border-gray-700 rounded-lg p-4 text-center">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl mr-2">⏳</span>
                            <span class="text-lg font-semibold text-gray-600 dark:text-gray-400">尚無班級到達</span>
                        </div>
                        <p class="text-gray-500 dark:text-gray-500 text-sm">班級到達後會顯示在這裡</p>
                    </div>
                `;
            } else {
                // 為每個年級分配對比色
                const getClassColor = (className) => {
                    const grade = className.charAt(0); // 取得年級數字
                    const colors = {
                        '1': 'bg-red-300 text-red-900 border-red-400 dark:bg-red-700/60 dark:text-red-100 dark:border-red-500', // 1年級：紅色系（對比綠色）
                        '2': 'bg-blue-300 text-blue-900 border-blue-400 dark:bg-blue-700/60 dark:text-blue-100 dark:border-blue-500', // 2年級：藍色系（對比綠色）
                        '3': 'bg-purple-300 text-purple-900 border-purple-400 dark:bg-purple-700/60 dark:text-purple-100 dark:border-purple-500' // 3年級：紫色系（對比綠色）
                    };
                    return colors[grade] || 'bg-gray-300 text-gray-900 border-gray-400 dark:bg-gray-700/60 dark:text-gray-100 dark:border-gray-500';
                };

                // 專為1920x1200優化，更大的班級方塊和字體
                const arrivedList = arrivedClasses.map(cls => 
                    `<div class="flex items-center justify-center text-9xl font-black ${getClassColor(cls.name)} rounded-3xl border-8 shadow-2xl" style="width: 210px; height: 210px;">
                        ${cls.name}
                    </div>`
                ).join('');
                
                // 補齊空位以保持網格完整
                const totalSlots = 12;
                const emptySlots = totalSlots - arrivedClasses.length;
                const emptyList = Array(emptySlots).fill('').map(() => 
                    `<div style="width: 210px; height: 210px;"></div>`
                ).join('');
                
                const gradeRows = `<div class="grid grid-cols-4 grid-rows-3 justify-items-center items-center h-full" style="gap: 50px;">${arrivedList}${emptyList}</div>`;
                
                pendingAlertDiv.innerHTML = `
                    <div class="bg-green-100 dark:bg-green-900/50 border-4 border-green-600 dark:border-green-500 rounded-xl p-6 shadow-2xl">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <span class="text-8xl mr-6">✅</span>
                                <span class="text-6xl font-black text-green-900 dark:text-green-200">已到達的班級</span>
                            </div>
                            <span class="px-6 py-3 text-4xl font-black bg-green-700 text-white rounded-xl shadow-lg">
                                ${arrivedClasses.length} 個班級
                            </span>
                        </div>
                        ${gradeRows}
                    </div>
                `;
            }
        }

        // 更新手機版已到達班級顯示區
        function updatePendingAlertMobile() {
            const pendingAlertDiv = document.getElementById('pendingAlertMobile');
            const arrivedClasses = classes.filter(cls => classStatus[cls.id]);
            
            if (arrivedClasses.length === 0) {
                pendingAlertDiv.innerHTML = `
                    <div class="bg-gray-50 dark:bg-gray-800/30 border border-gray-200 dark:border-gray-700 rounded-lg p-3 text-center">
                        <div class="flex items-center justify-center">
                            <span class="text-lg mr-2">⏳</span>
                            <span class="text-sm font-semibold text-gray-600 dark:text-gray-400">尚無班級到達</span>
                        </div>
                    </div>
                `;
            } else {
                // 為每個年級分配對比色 (手機版)
                const getClassColorMobile = (className) => {
                    const grade = className.charAt(0); // 取得年級數字
                    const colors = {
                        '1': 'bg-red-200 text-red-800 dark:bg-red-800/40 dark:text-red-200', // 1年級：紅色系（對比綠色）
                        '2': 'bg-blue-200 text-blue-800 dark:bg-blue-800/40 dark:text-blue-200', // 2年級：藍色系（對比綠色）
                        '3': 'bg-purple-200 text-purple-800 dark:bg-purple-800/40 dark:text-purple-200' // 3年級：紫色系（對比綠色）
                    };
                    return colors[grade] || 'bg-gray-200 text-gray-800 dark:bg-gray-800/40 dark:text-gray-200';
                };

                // 手機版：更緊湊的顯示 - 每個班級不同顏色
                const arrivedList = arrivedClasses.map(cls => 
                    `<span class="inline-flex items-center justify-center w-10 h-10 text-sm font-bold ${getClassColorMobile(cls.name)}">
                        ${cls.name}
                    </span>`
                ).join('');
                
                pendingAlertDiv.innerHTML = `
                    <div class="bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg p-3">
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">✅</span>
                            <span class="text-sm font-bold text-green-800 dark:text-green-300">已到達的班級</span>
                            <span class="ml-2 px-2 py-1 text-xs font-bold bg-green-600 text-white rounded">
                                ${arrivedClasses.length}
                            </span>
                        </div>
                        <div class="grid grid-cols-6 gap-1">
                            ${arrivedList}
                        </div>
                    </div>
                `;
            }
        }

        // 初始化應用
        function initApp() {
            updateConnectionStatus(false);
            initializeClasses();
            renderClasses();
            waitForFirebase();
        }

        // 啟動應用
        initApp();
    </script>
</body>
</html>
